macro = {
    0: "MacroAttackStage.NONE",
    1: "MacroAttackStage.PASSIVE_RECON",
    2: "MacroAttackStage.ACTIVE_RECON",
    3: "MacroAttackStage.PRIVLEDGE_ESC",
    4: "MacroAttackStage.ENSURE_ACCESS",
    5: "MacroAttackStage.TARGETED_EXP",
    6: "MacroAttackStage.ZERO_DAY",
    7: "MacroAttackStage.DISRUPT",
    8: "MacroAttackStage.DISTROY",
    9: "MacroAttackStage.DISTORT",
    10: "MacroAttackStage.DISCLOSURE",
    11: "MacroAttackStage.DELIVERY"
}
macro_inv = {v: k for k, v in macro.items()}

micro = {
    0: "MicroAttackStage.INIT",
    1: "MicroAttackStage.TARGET_IDEN",
    2: "MicroAttackStage.SURFING",
    3: "MicroAttackStage.SOCIAL_ENGINEERING",
    4: "MicroAttackStage.HOST_DISC",
    5: "MicroAttackStage.SERVICE_DISC",
    6: "MicroAttackStage.VULN_DISC",
    7: "MicroAttackStage.INFO_DISC",
    10: "MicroAttackStage.USER_PRIV_ESC",
    11: "MicroAttackStage.ROOT_PRIV_ESC",
    12: "MicroAttackStage.NETWORK_SNIFFING",
    13: "MicroAttackStage.BRUTE_FORCE_CREDS",
    14: "MicroAttackStage.ACCT_MANIP",
    15: "MicroAttackStage.TRUSTED_ORG_EXP",
    16: "MicroAttackStage.PUBLIC_APP_EXP",
    17: "MicroAttackStage.REMOTE_SERVICE_EXP",
    18: "MicroAttackStage.SPEARPHISHING",
    19: "MicroAttackStage.SERVICE_SPECIFIC",
    20: "MicroAttackStage.DEFENSE_EVASION",
    21: "MicroAttackStage.COMMAND_AND_CONTROL",
    22: "MicroAttackStage.LATERAL_MOVEMENT",
    23: "MicroAttackStage.ARBITRARY_CODE_EXE",
    99: "MicroAttackStage.PRIV_ESC",
    100: "MicroAttackStage.END_POINT_DOS",
    101: "MicroAttackStage.NETWORK_DOS",
    102: "MicroAttackStage.SERVICE_STOP",
    103: "MicroAttackStage.RESOURCE_HIJACKING",
    104: "MicroAttackStage.DATA_DESTRUCTION",
    105: "MicroAttackStage.CONTENT_WIPE",
    106: "MicroAttackStage.DATA_ENCRYPTION",
    107: "MicroAttackStage.DEFACEMENT",
    108: "MicroAttackStage.DATA_MANIPULATION",
    109: "MicroAttackStage.DATA_EXFILTRATION",
    110: "MicroAttackStage.DATA_DELIVERY",
    111: "MicroAttackStage.PHISHING",
    # ATT&CK for ICS techniques
    200: "MicroAttackStage.DRIVE_BY_COMPROMISE",
    201: "MicroAttackStage.EXPLOIT_PUBLIC_FACING_APP_ICS",
    202: "MicroAttackStage.EXPLOITATION_OF_REMOTE_SERVICES_ICS",
    203: "MicroAttackStage.EXTERNAL_REMOTE_SERVICES",
    204: "MicroAttackStage.INTERNET_ACCESSIBLE_DEVICE",
    205: "MicroAttackStage.REMOTE_SERVICES_ICS",
    206: "MicroAttackStage.REPLICATION_THROUGH_REMOVABLE_MEDIA",
    207: "MicroAttackStage.ROGUE_MASTER",
    208: "MicroAttackStage.SPEARPHISHING_ATTACHMENT_ICS",
    209: "MicroAttackStage.SUPPLY_CHAIN_COMPROMISE",
    210: "MicroAttackStage.TRANSIENT_CYBER_ASSET",
    211: "MicroAttackStage.WIRELESS_COMPROMISE",
    212: "MicroAttackStage.AUTORUN_IMAGE",
    213: "MicroAttackStage.CHANGE_OPERATING_MODE",
    214: "MicroAttackStage.COMMAND_LINE_INTERFACE_ICS",
    215: "MicroAttackStage.EXECUTION_THROUGH_API",
    216: "MicroAttackStage.GRAPHICAL_USER_INTERFACE",
    217: "MicroAttackStage.HOOKING_ICS",
    218: "MicroAttackStage.MODIFY_CONTROLLER_TASKING",
    219: "MicroAttackStage.NATIVE_API_ICS",
    220: "MicroAttackStage.SCRIPTING_ICS",
    221: "MicroAttackStage.USER_EXECUTION_ICS",
    222: "MicroAttackStage.HARDCODED_CREDENTIALS",
    223: "MicroAttackStage.MODIFY_PROGRAM",
    224: "MicroAttackStage.MODULE_FIRMWARE",
    225: "MicroAttackStage.PROJECT_FILE_INFECTION",
    226: "MicroAttackStage.SYSTEM_FIRMWARE",
    227: "MicroAttackStage.VALID_ACCOUNTS_ICS",
    228: "MicroAttackStage.EXPLOITATION_FOR_PRIVILEGE_ESCALATION",
    229: "MicroAttackStage.EXPLOITATION_FOR_EVASION",
    230: "MicroAttackStage.INDICATOR_REMOVAL_ON_HOST_ICS",
    231: "MicroAttackStage.MASQUERADING_ICS",
    232: "MicroAttackStage.ROOTKIT_ICS",
    233: "MicroAttackStage.SPOOF_REPORTING_MESSAGE",
    234: "MicroAttackStage.SYSTEM_BINARY_PROXY_EXECUTION",
    235: "MicroAttackStage.NETWORK_CONNECTION_ENUMERATION",
    236: "MicroAttackStage.NETWORK_SNIFFING_ICS",
    237: "MicroAttackStage.REMOTE_SYSTEM_DISCOVERY_ICS",
    238: "MicroAttackStage.REMOTE_SYSTEM_INFORMATION_DISCOVERY",
    239: "MicroAttackStage.WIRELESS_SNIFFING",
    240: "MicroAttackStage.DEFAULT_CREDENTIALS",
    241: "MicroAttackStage.LATERAL_TOOL_TRANSFER",
    242: "MicroAttackStage.PROGRAM_DOWNLOAD",
    243: "MicroAttackStage.ADVERSARY_IN_THE_MIDDLE_ICS",
    244: "MicroAttackStage.AUTOMATED_COLLECTION_ICS",
    245: "MicroAttackStage.DATA_FROM_INFORMATION_REPOSITORIES_ICS",
    246: "MicroAttackStage.DATA_FROM_LOCAL_SYSTEM_ICS",
    247: "MicroAttackStage.DETECT_OPERATING_MODE",
    248: "MicroAttackStage.IO_IMAGE",
    249: "MicroAttackStage.MONITOR_PROCESS_STATE",
    250: "MicroAttackStage.POINT_AND_TAG_IDENTIFICATION",
    251: "MicroAttackStage.PROGRAM_UPLOAD",
    252: "MicroAttackStage.SCREEN_CAPTURE_ICS",
    253: "MicroAttackStage.COMMONLY_USED_PORT",
    254: "MicroAttackStage.CONNECTION_PROXY",
    255: "MicroAttackStage.STANDARD_APPLICATION_LAYER_PROTOCOL",
    256: "MicroAttackStage.ACTIVATE_FIRMWARE_UPDATE_MODE",
    257: "MicroAttackStage.ALARM_SUPPRESSION",
    258: "MicroAttackStage.BLOCK_COMMAND_MESSAGE",
    259: "MicroAttackStage.BLOCK_REPORTING_MESSAGE",
    260: "MicroAttackStage.BLOCK_SERIAL_COM",
    261: "MicroAttackStage.CHANGE_CREDENTIAL",
    262: "MicroAttackStage.DATA_DESTRUCTION_ICS",
    263: "MicroAttackStage.DENIAL_OF_SERVICE_ICS",
    264: "MicroAttackStage.DEVICE_RESTART_SHUTDOWN",
    265: "MicroAttackStage.MANIPULATE_IO_IMAGE",
    266: "MicroAttackStage.MODIFY_ALARM_SETTINGS",
    267: "MicroAttackStage.SERVICE_STOP_ICS",
    268: "MicroAttackStage.BRUTE_FORCE_IO",
    269: "MicroAttackStage.MODIFY_PARAMETERS",
    270: "MicroAttackStage.UNAUTHORIZED_COMMAND_MESSAGE",
    271: "MicroAttackStage.DAMAGE_TO_PROPERTY",
    272: "MicroAttackStage.DENIAL_OF_CONTROL",
    273: "MicroAttackStage.DENIAL_OF_VIEW",
    274: "MicroAttackStage.LOSS_OF_AVAILABILITY",
    275: "MicroAttackStage.LOSS_OF_CONTROL",
    276: "MicroAttackStage.LOSS_OF_PRODUCTIVITY_AND_REVENUE",
    277: "MicroAttackStage.LOSS_OF_PROTECTION",
    278: "MicroAttackStage.LOSS_OF_SAFETY",
    279: "MicroAttackStage.LOSS_OF_VIEW",
    280: "MicroAttackStage.MANIPULATION_OF_CONTROL",
    281: "MicroAttackStage.MANIPULATION_OF_VIEW",
    282: "MicroAttackStage.THEFT_OF_OPERATIONAL_INFORMATION",
    999: "MicroAttackStage.NON_MALICIOUS"
}
micro_inv = {v: k for k, v in micro.items()}

micro2macro = {
    "MicroAttackStage.TARGET_IDEN": "MacroAttackStage.PASSIVE_RECON",
    "MicroAttackStage.SURFING": "MacroAttackStage.PASSIVE_RECON",
    "MicroAttackStage.SOCIAL_ENGINEERING": "MacroAttackStage.PASSIVE_RECON",
    "MicroAttackStage.HOST_DISC": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.SERVICE_DISC": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.VULN_DISC": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.INFO_DISC": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.PRIV_ESC": "MacroAttackStage.PRIVLEDGE_ESC",
    "MicroAttackStage.USER_PRIV_ESC": "MacroAttackStage.PRIVLEDGE_ESC",
    "MicroAttackStage.ROOT_PRIV_ESC": "MacroAttackStage.PRIVLEDGE_ESC",
    "MicroAttackStage.NETWORK_SNIFFING": "MacroAttackStage.PRIVLEDGE_ESC",
    "MicroAttackStage.BRUTE_FORCE_CREDS": "MacroAttackStage.PRIVLEDGE_ESC",
    "MicroAttackStage.ACCT_MANIP": "MacroAttackStage.PRIVLEDGE_ESC",
    "MicroAttackStage.TRUSTED_ORG_EXP": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.PUBLIC_APP_EXP": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.REMOTE_SERVICE_EXP": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.SPEARPHISHING": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.SERVICE_SPECIFIC": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.ARBITRARY_CODE_EXE": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.DEFENSE_EVASION": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.COMMAND_AND_CONTROL": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.LATERAL_MOVEMENT": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.END_POINT_DOS": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.NETWORK_DOS": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.SERVICE_STOP": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.RESOURCE_HIJACKING": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.DATA_DESTRUCTION": "MacroAttackStage.DISTROY",
    "MicroAttackStage.CONTENT_WIPE": "MacroAttackStage.DISTROY",
    "MicroAttackStage.DATA_ENCRYPTION": "MacroAttackStage.DISTORT",
    "MicroAttackStage.DEFACEMENT": "MacroAttackStage.DISTORT",
    "MicroAttackStage.DATA_MANIPULATION": "MacroAttackStage.DISTORT",
    "MicroAttackStage.DATA_EXFILTRATION": "MacroAttackStage.DISCLOSURE",
    "MicroAttackStage.DATA_DELIVERY": "MacroAttackStage.DELIVERY",
    "MicroAttackStage.PHISHING": "MacroAttackStage.DELIVERY",
    
    # ATT&CK for ICS - Initial Access
    "MicroAttackStage.DRIVE_BY_COMPROMISE": "MacroAttackStage.DELIVERY",
    "MicroAttackStage.EXPLOIT_PUBLIC_FACING_APP_ICS": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.EXPLOITATION_OF_REMOTE_SERVICES_ICS": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.EXTERNAL_REMOTE_SERVICES": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.INTERNET_ACCESSIBLE_DEVICE": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.REMOTE_SERVICES_ICS": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.REPLICATION_THROUGH_REMOVABLE_MEDIA": "MacroAttackStage.DELIVERY",
    "MicroAttackStage.ROGUE_MASTER": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.SPEARPHISHING_ATTACHMENT_ICS": "MacroAttackStage.DELIVERY",
    "MicroAttackStage.SUPPLY_CHAIN_COMPROMISE": "MacroAttackStage.DELIVERY",
    "MicroAttackStage.TRANSIENT_CYBER_ASSET": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.WIRELESS_COMPROMISE": "MacroAttackStage.TARGETED_EXP",
    
    # ATT&CK for ICS - Execution
    "MicroAttackStage.AUTORUN_IMAGE": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.CHANGE_OPERATING_MODE": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.COMMAND_LINE_INTERFACE_ICS": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.EXECUTION_THROUGH_API": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.GRAPHICAL_USER_INTERFACE": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.HOOKING_ICS": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.MODIFY_CONTROLLER_TASKING": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.NATIVE_API_ICS": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.SCRIPTING_ICS": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.USER_EXECUTION_ICS": "MacroAttackStage.TARGETED_EXP",
    
    # ATT&CK for ICS - Persistence
    "MicroAttackStage.HARDCODED_CREDENTIALS": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.MODIFY_PROGRAM": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.MODULE_FIRMWARE": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.PROJECT_FILE_INFECTION": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.SYSTEM_FIRMWARE": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.VALID_ACCOUNTS_ICS": "MacroAttackStage.ENSURE_ACCESS",
    
    # ATT&CK for ICS - Privilege Escalation
    "MicroAttackStage.EXPLOITATION_FOR_PRIVILEGE_ESCALATION": "MacroAttackStage.PRIVLEDGE_ESC",
    
    # ATT&CK for ICS - Evasion
    "MicroAttackStage.EXPLOITATION_FOR_EVASION": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.INDICATOR_REMOVAL_ON_HOST_ICS": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.MASQUERADING_ICS": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.ROOTKIT_ICS": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.SPOOF_REPORTING_MESSAGE": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.SYSTEM_BINARY_PROXY_EXECUTION": "MacroAttackStage.ENSURE_ACCESS",
    
    # ATT&CK for ICS - Discovery
    "MicroAttackStage.NETWORK_CONNECTION_ENUMERATION": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.NETWORK_SNIFFING_ICS": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.REMOTE_SYSTEM_DISCOVERY_ICS": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.REMOTE_SYSTEM_INFORMATION_DISCOVERY": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.WIRELESS_SNIFFING": "MacroAttackStage.ACTIVE_RECON",
    
    # ATT&CK for ICS - Lateral Movement
    "MicroAttackStage.DEFAULT_CREDENTIALS": "MacroAttackStage.PRIVLEDGE_ESC",
    "MicroAttackStage.LATERAL_TOOL_TRANSFER": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.PROGRAM_DOWNLOAD": "MacroAttackStage.TARGETED_EXP",
    
    # ATT&CK for ICS - Collection
    "MicroAttackStage.ADVERSARY_IN_THE_MIDDLE_ICS": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.AUTOMATED_COLLECTION_ICS": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.DATA_FROM_INFORMATION_REPOSITORIES_ICS": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.DATA_FROM_LOCAL_SYSTEM_ICS": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.DETECT_OPERATING_MODE": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.IO_IMAGE": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.MONITOR_PROCESS_STATE": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.POINT_AND_TAG_IDENTIFICATION": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.PROGRAM_UPLOAD": "MacroAttackStage.ACTIVE_RECON",
    "MicroAttackStage.SCREEN_CAPTURE_ICS": "MacroAttackStage.ACTIVE_RECON",
    
    # ATT&CK for ICS - Command and Control
    "MicroAttackStage.COMMONLY_USED_PORT": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.CONNECTION_PROXY": "MacroAttackStage.ENSURE_ACCESS",
    "MicroAttackStage.STANDARD_APPLICATION_LAYER_PROTOCOL": "MacroAttackStage.ENSURE_ACCESS",
    
    # ATT&CK for ICS - Inhibit Response Function
    "MicroAttackStage.ACTIVATE_FIRMWARE_UPDATE_MODE": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.ALARM_SUPPRESSION": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.BLOCK_COMMAND_MESSAGE": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.BLOCK_REPORTING_MESSAGE": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.BLOCK_SERIAL_COM": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.CHANGE_CREDENTIAL": "MacroAttackStage.PRIVLEDGE_ESC",
    "MicroAttackStage.DATA_DESTRUCTION_ICS": "MacroAttackStage.DISTROY",
    "MicroAttackStage.DENIAL_OF_SERVICE_ICS": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.DEVICE_RESTART_SHUTDOWN": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.MANIPULATE_IO_IMAGE": "MacroAttackStage.DISTORT",
    "MicroAttackStage.MODIFY_ALARM_SETTINGS": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.SERVICE_STOP_ICS": "MacroAttackStage.DISRUPT",
    
    # ATT&CK for ICS - Impair Process Control
    "MicroAttackStage.BRUTE_FORCE_IO": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.MODIFY_PARAMETERS": "MacroAttackStage.TARGETED_EXP",
    "MicroAttackStage.UNAUTHORIZED_COMMAND_MESSAGE": "MacroAttackStage.TARGETED_EXP",
    
    # ATT&CK for ICS - Impact
    "MicroAttackStage.DAMAGE_TO_PROPERTY": "MacroAttackStage.DISTROY",
    "MicroAttackStage.DENIAL_OF_CONTROL": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.DENIAL_OF_VIEW": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.LOSS_OF_AVAILABILITY": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.LOSS_OF_CONTROL": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.LOSS_OF_PRODUCTIVITY_AND_REVENUE": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.LOSS_OF_PROTECTION": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.LOSS_OF_SAFETY": "MacroAttackStage.DISTROY",
    "MicroAttackStage.LOSS_OF_VIEW": "MacroAttackStage.DISRUPT",
    "MicroAttackStage.MANIPULATION_OF_CONTROL": "MacroAttackStage.DISTORT",
    "MicroAttackStage.MANIPULATION_OF_VIEW": "MacroAttackStage.DISTORT",
    "MicroAttackStage.THEFT_OF_OPERATIONAL_INFORMATION": "MacroAttackStage.DISCLOSURE",
    
    "MicroAttackStage.NON_MALICIOUS": "MacroAttackStage.NONE"
}

mcols = list({(0.8941176470588236, 0.10196078431372549, 0.10980392156862745),
              (0.21568627450980393, 0.49411764705882355, 0.7215686274509804),
              (0.30196078431372547, 0.6862745098039216, 0.2901960784313726),
              (0.596078431372549, 0.3058823529411765, 0.6392156862745098), (1.0, 0.4980392156862745, 0.0),
              (0.6509803921568628, 0.33725490196078434, 0.1568627450980392),
              (0.9686274509803922, 0.5058823529411764, 0.7490196078431373), (0.6, 0.6, 0.6),
              (0.4, 0.7607843137254902, 0.6470588235294118),
              (0.9882352941176471, 0.5529411764705883, 0.3843137254901961),
              (0.5529411764705883, 0.6274509803921569, 0.796078431372549),
              (0.9058823529411765, 0.5411764705882353, 0.7647058823529411),
              (0.6509803921568628, 0.8470588235294118, 0.32941176470588235),
              (1.0, 0.8509803921568627, 0.1843137254901961),
              (0.8980392156862745, 0.7686274509803922, 0.5803921568627451),
              (0.7019607843137254, 0.7019607843137254, 0.7019607843137254),
              (0.12156862745098039, 0.4666666666666667, 0.7058823529411765),
              (1.0, 0.4980392156862745, 0.054901960784313725),
              (0.17254901960784313, 0.6274509803921569, 0.17254901960784313),
              (0.8392156862745098, 0.15294117647058825, 0.1568627450980392),
              (0.5803921568627451, 0.403921568627451, 0.7411764705882353),
              (0.5490196078431373, 0.33725490196078434, 0.29411764705882354),
              (0.8901960784313725, 0.4666666666666667, 0.7607843137254902),
              (0.4980392156862745, 0.4980392156862745, 0.4980392156862745),
              (0.7372549019607844, 0.7411764705882353, 0.13333333333333333),
              (0.09019607843137255, 0.7450980392156863, 0.8117647058823529),
              (0.10588235294117647, 0.6196078431372549, 0.4666666666666667),
              (0.8509803921568627, 0.37254901960784315, 0.00784313725490196),
              (0.4588235294117647, 0.4392156862745098, 0.7019607843137254),
              (0.9058823529411765, 0.1607843137254902, 0.5411764705882353),
              (0.4, 0.6509803921568628, 0.11764705882352941),
              (0.9019607843137255, 0.6705882352941176, 0.00784313725490196),
              (0.6509803921568628, 0.4627450980392157, 0.11372549019607843), (0.4, 0.4, 0.4),
              (0.4980392156862745, 0.788235294117647, 0.4980392156862745),
              (0.7450980392156863, 0.6823529411764706, 0.8313725490196079),
              (0.9921568627450981, 0.7529411764705882, 0.5254901960784314),
              (0.2196078431372549, 0.4235294117647059, 0.6901960784313725),
              (0.9411764705882353, 0.00784313725490196, 0.4980392156862745),
              (0.7490196078431373, 0.3568627450980392, 0.09019607843137253), (0.4, 0.4, 0.4),
              (0.984313725490196, 0.7058823529411765, 0.6823529411764706),
              (0.7019607843137254, 0.803921568627451, 0.8901960784313725),
              (0.8, 0.9215686274509803, 0.7725490196078432),
              (0.8705882352941177, 0.796078431372549, 0.8941176470588236),
              (0.996078431372549, 0.8509803921568627, 0.6509803921568628),
              (0.8980392156862745, 0.8470588235294118, 0.7411764705882353),
              (0.9921568627450981, 0.8549019607843137, 0.9254901960784314)})

small_mapping = {
    1: "tarID",
    2: "surf",
    4: "hostD",
    5: "serD",
    6: "vulnD",
    7: "infoD",
    10: "uPrivEsc",
    11: "rPrivEsc",
    12: "netSniff",
    13: "bfCred",
    14: "acctManip",
    15: "TOexp",
    16: "PAexp",
    17: "remoteexp",
    18: "sPhish",
    19: "servS",
    20: "evasion",
    21: "CnC",
    22: "lateral",
    23: "ACE",
    99: "privEsc",
    100: "endDOS",
    101: "netDOS",
    102: "serStop",
    103: "resHJ",
    104: "dDestruct",
    105: "cWipe",
    106: "dEncrypt",
    107: "deface",
    108: "dManip",
    109: "exfil",
    110: "delivery",
    111: "phish",
    # ATT&CK for ICS techniques
    200: "driveByComp",
    201: "explPubApp",
    202: "explRemSrv",
    203: "extRemSrv",
    204: "inetAccDev",
    205: "remSrvICS",
    206: "replRemMed",
    207: "rogueMstr",
    208: "spearAttch",
    209: "supplyChain",
    210: "transAsset",
    211: "wirelessCmp",
    212: "autorunImg",
    213: "chgOpMode",
    214: "cmdLineICS",
    215: "execAPI",
    216: "GUI",
    217: "hookICS",
    218: "modCtrlTask",
    219: "nativeAPI",
    220: "scriptICS",
    221: "userExecICS",
    222: "hardCreds",
    223: "modProgram",
    224: "modFirmware",
    225: "projInfect",
    226: "sysFirmware",
    227: "validAccts",
    228: "explPrivEsc",
    229: "explEvasion",
    230: "indRemoval",
    231: "masquerade",
    232: "rootkitICS",
    233: "spoofReport",
    234: "sysBinProxy",
    235: "netConnEnum",
    236: "netSniffICS",
    237: "remSysDisc",
    238: "remSysInfo",
    239: "wirelessSnf",
    240: "defCreds",
    241: "latToolTrf",
    242: "progDown",
    243: "advInMiddle",
    244: "autoCollect",
    245: "dataInfoRep",
    246: "dataLocal",
    247: "detectOpMod",
    248: "ioImage",
    249: "monProcSt",
    250: "ptTagId",
    251: "progUp",
    252: "screenCap",
    253: "commonPort",
    254: "connProxy",
    255: "stdAppProto",
    256: "actFwUpdate",
    257: "alarmSuppr",
    258: "blkCmdMsg",
    259: "blkRptMsg",
    260: "blkSerialCom",
    261: "chgCred",
    262: "dataDestICS",
    263: "dosICS",
    264: "devRestart",
    265: "manipIOImg",
    266: "modAlarmSet",
    267: "srvStopICS",
    268: "bruteForceIO",
    269: "modParam",
    270: "unauthCmd",
    271: "dmgProperty",
    272: "denialCtrl",
    273: "denialView",
    274: "lossAvail",
    275: "lossCtrl",
    276: "lossProdRev",
    277: "lossProt",
    278: "lossSafety",
    279: "lossView",
    280: "manipCtrl",
    281: "manipView",
    282: "theftOpInfo",
    999: "benign"
}
rev_smallmapping = dict([(value, key) for key, value in small_mapping.items()])

verbose_micro = {
    "INIT": "INITILIZE",
    "TARGET_IDEN": "TARGET IDENTIFICATION",
    "SURFING": "SURFING",
    "SOCIAL_ENGINEERING": "SOCIAL ENGINEERING",
    "HOST_DISC": "HOST DISCOVERY",
    "SERVICE_DISC": "SERVICE DISCOVERY",
    "VULN_DISC": "VULNERABILTY DISCOVERY",
    "INFO_DISC": "INFO DISCOVERY",
    "USER_PRIV_ESC": "USER PRIVILEGE ESCALATION",
    "ROOT_PRIV_ESC": "ROOT PRIVILEGE ESCALATION",
    "NETWORK_SNIFFING": "NETWORK SNIFFING",
    "BRUTE_FORCE_CREDS": "BRUTE FORCE CREDENTIALS",
    "ACCT_MANIP": "ACCOUNT MANIPULATION",
    "TRUSTED_ORG_EXP": "TRUSTED ORG. EXPLOIT",
    "PUBLIC_APP_EXP": "PUBLIC APP EXPLOIT",
    "REMOTE_SERVICE_EXP": "REMOTE SERVICE EXPLOIT",
    "SPEARPHISHING": "SPEAR PHISHING",
    "SERVICE_SPECIFIC": "SERVICE SPECIFIC",
    "DEFENSE_EVASION": "DEFENSE EVASION",
    "COMMAND_AND_CONTROL": "COMMAND AND CONTROL",
    "LATERAL_MOVEMENT": "LATERAL MOVEMENT",
    "ARBITRARY_CODE_EXE": "ARBITRARY CODE EXECUTION",
    "PRIV_ESC": "PRIVILEGE ESCALATION",
    "END_POINT_DOS": "END POINT DoS",
    "NETWORK_DOS": "NETWORK DoS",
    "SERVICE_STOP": "SERVICE STOP",
    "RESOURCE_HIJACKING": "RESOURCE HIJACKING",
    "DATA_DESTRUCTION": "DATA DESTRUCTION",
    "CONTENT_WIPE": "CONTENT WIPE",
    "DATA_ENCRYPTION": "DATA ENCRYPTION",
    "DEFACEMENT": "DEFACEMENT",
    "DATA_MANIPULATION": "DATA MANIPULATION",
    "DATA_EXFILTRATION": "DATA EXFILTRATION",
    "DATA_DELIVERY": "DATA DELIVERY",
    "PHISHING": "PHISHING",
    # ATT&CK for ICS techniques - Initial Access
    "DRIVE_BY_COMPROMISE": "DRIVE-BY COMPROMISE (T0817)",
    "EXPLOIT_PUBLIC_FACING_APP_ICS": "EXPLOIT PUBLIC-FACING APPLICATION (T0819)",
    "EXPLOITATION_OF_REMOTE_SERVICES_ICS": "EXPLOITATION OF REMOTE SERVICES (T0866)",
    "EXTERNAL_REMOTE_SERVICES": "EXTERNAL REMOTE SERVICES (T0822)",
    "INTERNET_ACCESSIBLE_DEVICE": "INTERNET ACCESSIBLE DEVICE (T0883)",
    "REMOTE_SERVICES_ICS": "REMOTE SERVICES (T0886)",
    "REPLICATION_THROUGH_REMOVABLE_MEDIA": "REPLICATION THROUGH REMOVABLE MEDIA (T0847)",
    "ROGUE_MASTER": "ROGUE MASTER (T0848)",
    "SPEARPHISHING_ATTACHMENT_ICS": "SPEARPHISHING ATTACHMENT (T0865)",
    "SUPPLY_CHAIN_COMPROMISE": "SUPPLY CHAIN COMPROMISE (T0862)",
    "TRANSIENT_CYBER_ASSET": "TRANSIENT CYBER ASSET (T0864)",
    "WIRELESS_COMPROMISE": "WIRELESS COMPROMISE (T0860)",
    
    # Execution
    "AUTORUN_IMAGE": "AUTORUN IMAGE (T0895)",
    "CHANGE_OPERATING_MODE": "CHANGE OPERATING MODE (T0858)",
    "COMMAND_LINE_INTERFACE_ICS": "COMMAND-LINE INTERFACE (T0807)",
    "EXECUTION_THROUGH_API": "EXECUTION THROUGH API (T0871)",
    "GRAPHICAL_USER_INTERFACE": "GRAPHICAL USER INTERFACE (T0823)",
    "HOOKING_ICS": "HOOKING (T0874)",
    "MODIFY_CONTROLLER_TASKING": "MODIFY CONTROLLER TASKING (T0821)",
    "NATIVE_API_ICS": "NATIVE API (T0834)",
    "SCRIPTING_ICS": "SCRIPTING (T0853)",
    "USER_EXECUTION_ICS": "USER EXECUTION (T0863)",
    
    # Persistence
    "HARDCODED_CREDENTIALS": "HARDCODED CREDENTIALS (T0891)",
    "MODIFY_PROGRAM": "MODIFY PROGRAM (T0889)",
    "MODULE_FIRMWARE": "MODULE FIRMWARE (T0839)",
    "PROJECT_FILE_INFECTION": "PROJECT FILE INFECTION (T0873)",
    "SYSTEM_FIRMWARE": "SYSTEM FIRMWARE (T0857)",
    "VALID_ACCOUNTS_ICS": "VALID ACCOUNTS (T0859)",
    
    # Privilege Escalation
    "EXPLOITATION_FOR_PRIVILEGE_ESCALATION": "EXPLOITATION FOR PRIVILEGE ESCALATION (T0890)",
    
    # Evasion
    "EXPLOITATION_FOR_EVASION": "EXPLOITATION FOR EVASION (T0820)",
    "INDICATOR_REMOVAL_ON_HOST_ICS": "INDICATOR REMOVAL ON HOST (T0872)",
    "MASQUERADING_ICS": "MASQUERADING (T0849)",
    "ROOTKIT_ICS": "ROOTKIT (T0851)",
    "SPOOF_REPORTING_MESSAGE": "SPOOF REPORTING MESSAGE (T0856)",
    "SYSTEM_BINARY_PROXY_EXECUTION": "SYSTEM BINARY PROXY EXECUTION (T0894)",
    
    # Discovery
    "NETWORK_CONNECTION_ENUMERATION": "NETWORK CONNECTION ENUMERATION (T0840)",
    "NETWORK_SNIFFING_ICS": "NETWORK SNIFFING (T0842)",
    "REMOTE_SYSTEM_DISCOVERY_ICS": "REMOTE SYSTEM DISCOVERY (T0846)",
    "REMOTE_SYSTEM_INFORMATION_DISCOVERY": "REMOTE SYSTEM INFORMATION DISCOVERY (T0888)",
    "WIRELESS_SNIFFING": "WIRELESS SNIFFING (T0887)",
    
    # Lateral Movement
    "DEFAULT_CREDENTIALS": "DEFAULT CREDENTIALS (T0812)",
    "LATERAL_TOOL_TRANSFER": "LATERAL TOOL TRANSFER (T0867)",
    "PROGRAM_DOWNLOAD": "PROGRAM DOWNLOAD (T0843)",
    
    # Collection
    "ADVERSARY_IN_THE_MIDDLE_ICS": "ADVERSARY-IN-THE-MIDDLE (T0830)",
    "AUTOMATED_COLLECTION_ICS": "AUTOMATED COLLECTION (T0802)",
    "DATA_FROM_INFORMATION_REPOSITORIES_ICS": "DATA FROM INFORMATION REPOSITORIES (T0811)",
    "DATA_FROM_LOCAL_SYSTEM_ICS": "DATA FROM LOCAL SYSTEM (T0893)",
    "DETECT_OPERATING_MODE": "DETECT OPERATING MODE (T0868)",
    "IO_IMAGE": "I/O IMAGE (T0877)",
    "MONITOR_PROCESS_STATE": "MONITOR PROCESS STATE (T0801)",
    "POINT_AND_TAG_IDENTIFICATION": "POINT & TAG IDENTIFICATION (T0861)",
    "PROGRAM_UPLOAD": "PROGRAM UPLOAD (T0845)",
    "SCREEN_CAPTURE_ICS": "SCREEN CAPTURE (T0852)",
    
    # Command and Control
    "COMMONLY_USED_PORT": "COMMONLY USED PORT (T0885)",
    "CONNECTION_PROXY": "CONNECTION PROXY (T0884)",
    "STANDARD_APPLICATION_LAYER_PROTOCOL": "STANDARD APPLICATION LAYER PROTOCOL (T0869)",
    
    # Inhibit Response Function
    "ACTIVATE_FIRMWARE_UPDATE_MODE": "ACTIVATE FIRMWARE UPDATE MODE (T0800)",
    "ALARM_SUPPRESSION": "ALARM SUPPRESSION (T0878)",
    "BLOCK_COMMAND_MESSAGE": "BLOCK COMMAND MESSAGE (T0803)",
    "BLOCK_REPORTING_MESSAGE": "BLOCK REPORTING MESSAGE (T0804)",
    "BLOCK_SERIAL_COM": "BLOCK SERIAL COM (T0805)",
    "CHANGE_CREDENTIAL": "CHANGE CREDENTIAL (T0892)",
    "DATA_DESTRUCTION_ICS": "DATA DESTRUCTION (T0809)",
    "DENIAL_OF_SERVICE_ICS": "DENIAL OF SERVICE (T0814)",
    "DEVICE_RESTART_SHUTDOWN": "DEVICE RESTART/SHUTDOWN (T0816)",
    "MANIPULATE_IO_IMAGE": "MANIPULATE I/O IMAGE (T0835)",
    "MODIFY_ALARM_SETTINGS": "MODIFY ALARM SETTINGS (T0838)",
    "SERVICE_STOP_ICS": "SERVICE STOP (T0881)",
    
    # Impair Process Control
    "BRUTE_FORCE_IO": "BRUTE FORCE I/O (T0806)",
    "MODIFY_PARAMETERS": "MODIFY PARAMETERS (T0836)",
    "UNAUTHORIZED_COMMAND_MESSAGE": "UNAUTHORIZED COMMAND MESSAGE (T0855)",
    
    # Impact
    "DAMAGE_TO_PROPERTY": "DAMAGE TO PROPERTY (T0879)",
    "DENIAL_OF_CONTROL": "DENIAL OF CONTROL (T0813)",
    "DENIAL_OF_VIEW": "DENIAL OF VIEW (T0815)",
    "LOSS_OF_AVAILABILITY": "LOSS OF AVAILABILITY (T0826)",
    "LOSS_OF_CONTROL": "LOSS OF CONTROL (T0827)",
    "LOSS_OF_PRODUCTIVITY_AND_REVENUE": "LOSS OF PRODUCTIVITY AND REVENUE (T0828)",
    "LOSS_OF_PROTECTION": "LOSS OF PROTECTION (T0837)",
    "LOSS_OF_SAFETY": "LOSS OF SAFETY (T0880)",
    "LOSS_OF_VIEW": "LOSS OF VIEW (T0829)",
    "MANIPULATION_OF_CONTROL": "MANIPULATION OF CONTROL (T0831)",
    "MANIPULATION_OF_VIEW": "MANIPULATION OF VIEW (T0832)",
    "THEFT_OF_OPERATIONAL_INFORMATION": "THEFT OF OPERATIONAL INFORMATION (T0882)",
    
    "NON_MALICIOUS": "NOT MALICIOUS"
}

ser_groups = dict({
    "http(s)": ["http", "https", "ddi-udp-1", "radan-http"],
    "wireless": ["wap-wsp"],
    "voip": ["sip", "sips"],
    "browser": ["vrml-multi-use"],
    "searchEng": ["search-agent"],
    "broadcast": ["ssdp", "snmp", "commplex-main", "icmpd", "wsdapi"],
    "nameserver": ["domain", "netbios-ns", "menandmice-dns"],
    "remoteAccess": ["ssh", "rfb", "us-cli", "ahsp", "spt-automation", "asf-rmcp", "xdmcp", "pcanywherestat", "esmagent",
                     "irdmi", "epmap", "wsman", "icslap", "ms-wbt-server", "appiq-mgmt", "sunrpc", "mosaicsyssvc1"],
    "surveillance": ["remoteware-cl", "ads-c", "syslog", "websm", "distinct", "irisa"],

    "hostingServer": ["cslistener", "etlservicemgr", "web2host"],

    "printService": ["pharos", "ipps"],
    # "sendEmail": ["smtp"],
    "migration": ["fs-agent"],
    "email": ["smtp", "imaps", "pop3", "imap", "pop3s", "submission"],
    "authentication": ["kerberos", "nv-video"],
    "ATCcomm": ["cpdlc", "fis"],

    "storage": ["http-alt", "ncube-lm", "postgresql", "mysql", "cm", "ms-sql-s", "ms-sql-m", "mongodb"],

    "dataSharing": ["ftp", "pcsync-https", "ndmp", "netbios-ssn", "microsoft-ds", "profinet-rt", "instantia"],
    "clocksync": ["ntp"],

    "unassigned": ["unknown", "Unknown"]
})
